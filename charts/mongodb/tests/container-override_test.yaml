suite: test container command and args overrides
templates:
  - statefulset.yaml
set:
  image:
    tag: 8.0.12@sha256:a6bda40d00e56682aeaa1bfc88e024b7dd755782c575c02760104fe02010f94f
tests:
  - it: should have default args when config.content is provided
    set:
      config:
        content: |
          systemLog:
            quiet: true
    asserts:
      - equal:
          path: spec.template.spec.containers[0].args[0]
          value: "--config"
      - equal:
          path: spec.template.spec.containers[0].args[1]
          value: "/etc/mongo/mongod.conf"

  - it: should have default args when config.existingConfigmap is provided
    set:
      config:
        content: ""
        existingConfigmap: "my-custom-configmap"
    asserts:
      - equal:
          path: spec.template.spec.containers[0].args[0]
          value: "--config"
      - equal:
          path: spec.template.spec.containers[0].args[1]
          value: "/etc/mongo/mongod.conf"